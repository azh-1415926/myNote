# **Linux 系统编程笔记**
## **Linux 磁盘管理**
Linux 磁盘管理好坏直接关系到整个系统的性能问题

Linux 磁盘管理常用三个命令为 df(disk free)、du(disk used) 和 fdisk
1. ### 检查文件系统磁盘空间占用情况 `df` 命令
    * `df -a` 列出所有的文件系统，包括系统特有的 /proc 等文件系统；
    * `df -k` 以 KBytes 的容量显示各文件系统；
    * `df -m` 以 MBytes 的容量显示各文件系统；
    * `df -h` 以人们较易阅读的 GBytes, MBytes, KBytes 等格式自行显示；
    * `df -H` 以 M=1000K 取代 M=1024K 的进位方式；
    * `df -T` 显示文件系统类型, 连同该 partition 的 filesystem 名称 (例如 ext3) 也列出；
    * `df -i` 不用硬盘容量，而以 inode 的数量来显示
2. ### 查看文件和目录的磁盘空间占用情况 `du` 命令
    * `du -a` 列出所有的文件与目录容量，因为默认仅统计目录底下的文件量而已
    * `du -h` 以人们较易读的容量格式 (G/M) 显示
    * `du -s` 列出总量而已，而不列出每个各别的目录占用容量
    * `du -S` 不包括子目录下的总计，与 -s 有点差别
    * `du -k` 以 KBytes 列出容量显示
    * `du -m` 以 MBytes 列出容量显示
3. ### 磁盘分区 `fdisk` 命令
    * `fidsk -l` 输出后面接的装置所有的分区内容。若仅有 fdisk -l 时， 则系统将会把整个系统内能够搜寻到的装置的分区均列出来
4. ### 磁盘格式化 `mkfs` 命令
    * 磁盘分割完毕后自然就是要进行文件系统的格式化，磁盘格式化mkfs(make filesystem)
    * `mkfs -t 格式 分区` 可以接文件系统格式，例如 ext3, ext2, vfat 等(系统有支持才会生效)
5. ### 磁盘检验 `fsck` 命令
    * fsck(file system check)用来检查和维护不一致的文件系统，若系统掉电或磁盘发生问题，可利用fsck命令对文件系统进行检查
    * 具体参数
        * -t 给定档案系统的型式，若在 /etc/fstab 中已有定义或 kernel 本身已支援的则不需加上此参数
        * -s 依序一个一个地执行 fsck 的指令来检查
        * -A 对/etc/fstab 中所有列出来的 分区（partition）做检查
        * -C 显示完整的检查进度
        * -d 打印出 e2fsck 的 debug 结果
        * -p 同时有 -A 条件时，同时有多个 fsck 的检查一起执行
        * -R 同时有 -A 条件时，省略 / 不检查
        * -V 详细显示模式
        * -a 如果检查有错则自动修复
        * -r 如果检查有错则由使用者回答是否修复
        * -y 选项指定检测每个文件是自动输入yes，在不确定那些是不正常的时候，可以执行 fsck -y 全部检查修复
6. ### 磁盘挂载与卸除
    * Linux 的磁盘挂载使用 mount 命令，卸载使用 umount 命令
        * -f 强制卸除！可用在类似网络文件系统 (NFS) 无法读取到的情况下
        * -n 不升级 /etc/mtab 情况下卸除